<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëŒ€ì‹œë³´ë“œ - Linky Business</title>
    
    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Supabase ì„¤ì • -->
    <script src="../supabase-config.js"></script>
    
    <!-- ìƒˆë¡œìš´ ì¸ì¦ ë° API -->
    <script src="../js/auth/auth-manager.js"></script>
    <script src="../js/auth/business-auth.js"></script>
    <script src="../js/api/business-api.js"></script>
    <script src="../js/auth-utils.js"></script>
    
    <script>
        // ê°„ë‹¨í•œ BusinessAPI í´ë˜ìŠ¤ (ì„ì‹œ)
        class BusinessAPI {
            constructor() {
                this.tableName = 'business_users';
            }

            async getProfile(authUid) {
                try {
                    const { data, error } = await window.supabaseClient
                        .from(this.tableName)
                        .select('*')
                        .eq('auth_uid', authUid)
                        .single();
                    if (error) throw error;
                    return { data, error: null };
                } catch (error) {
                    console.error('í”„ë¡œí•„ ì¡°íšŒ ì˜¤ë¥˜:', error);
                    return { data: null, error: error.message };
                }
            }

            async getStatistics(authUid) {
                try {
                    // ê³µê°„ ìˆ˜ ì¡°íšŒ
                    const { data: spaces } = await window.supabaseClient
                        .from('spaces')
                        .select('*')
                        .eq('owner_id', authUid);

                    // ì‘ì—… ì¡°íšŒ
                    const { data: jobs } = await window.supabaseClient
                        .from('jobs')
                        .select('*')
                        .eq('business_id', authUid);

                    const stats = {
                        monthly: {
                            pending_jobs: (jobs || []).filter(j => j.status === 'pending').length,
                            completed_jobs: (jobs || []).filter(j => j.status === 'completed').length,
                            total_jobs: (jobs || []).length,
                            monthly_spent: (jobs || []).filter(j => j.status === 'completed').reduce((sum, j) => sum + (j.price || 0), 0)
                        },
                        total: {
                            space_count: (spaces || []).length
                        }
                    };

                    return { data: stats, error: null };
                } catch (error) {
                    console.error('í†µê³„ ì¡°íšŒ ì˜¤ë¥˜:', error);
                    return { data: null, error: error.message };
                }
            }

            async getJobs(authUid) {
                try {
                    const { data, error } = await window.supabaseClient
                        .from('jobs')
                        .select(`
                            *,
                            space:spaces(name, address),
                            partner:partner_users(name, phone)
                        `)
                        .eq('business_id', authUid)
                        .order('created_at', { ascending: false });

                    if (error) throw error;
                    return { data, error: null };
                } catch (error) {
                    console.error('ì‘ì—… ëª©ë¡ ì¡°íšŒ ì˜¤ë¥˜:', error);
                    return { data: [], error: error.message };
                }
            }
        }

        // ì „ì—­ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
        window.businessAPI = new BusinessAPI();
        console.log('BusinessAPI ì¸ë¼ì¸ ë¡œë“œ ì™„ë£Œ');
    </script>
    
    <!-- ê³µí†µ ìŠ¤íƒ€ì¼ -->
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/components.css">
    
    <style>
        .dashboard-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            background: #f8fafc;
            min-height: calc(100vh - 200px);
        }
        
        .welcome-header {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }
        
        .welcome-title {
            font-size: 32px;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 10px;
        }
        
        .welcome-subtitle {
            color: #6b7280;
            font-size: 18px;
        }
        
        /* í†µê³„ ì¹´ë“œ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .stat-card {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: all 0.3s;
            cursor: pointer;
            text-decoration: none;
            color: inherit;
            display: block;
        }
        
        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.12);
        }
        
        .stat-card.pending-review {
            background: #fef3c7;
            border: 2px solid #f59e0b;
        }
        
        .stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .stat-icon {
            font-size: 40px;
        }
        
        .stat-badge {
            background: #ef4444;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .stat-number {
            font-size: 40px;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 8px;
        }
        
        .stat-label {
            color: #6b7280;
            font-size: 16px;
        }
        
        /* ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .section {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .section-title {
            font-size: 24px;
            font-weight: bold;
            color: #1f2937;
        }
        
        /* ë¹ ë¥¸ ì•¡ì…˜ ë²„íŠ¼ë“¤ */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .action-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 20px;
            background: #f3f4f6;
            border: 2px solid transparent;
            border-radius: 8px;
            font-weight: 600;
            color: #374151;
            transition: all 0.3s;
            cursor: pointer;
            text-decoration: none;
        }
        
        .action-button:hover {
            background: #22c55e;
            color: white;
            border-color: #22c55e;
        }
        
        .action-button .icon {
            font-size: 24px;
        }
        
        /* ì•Œë¦¼ ë°°ë„ˆ */
        .alert-banner {
            background: #fee2e2;
            border: 1px solid #fca5a5;
            border-radius: 8px;
            padding: 16px 20px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .alert-banner.warning {
            background: #fef3c7;
            border-color: #fcd34d;
        }
        
        .alert-banner.info {
            background: #dbeafe;
            border-color: #93c5fd;
        }
        
        .alert-icon {
            font-size: 20px;
            flex-shrink: 0;
        }
        
        /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .data-table th {
            background: #f9fafb;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .data-table td {
            padding: 16px 12px;
            border-bottom: 1px solid #f3f4f6;
        }
        
        .data-table tr:hover {
            background: #f9fafb;
        }
        
        /* ìƒíƒœ ë±ƒì§€ */
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-badge.pending {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-badge.in-progress {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .status-badge.completed {
            background: #d1fae5;
            color: #065f46;
        }
        
        /* ë¡œë”© ìƒíƒœ */
        .loading-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 400px;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f4f6;
            border-top: 5px solid #22c55e;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .dashboard-container {
                padding: 20px 15px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .quick-actions {
                grid-template-columns: 1fr;
            }
            
            .welcome-title {
                font-size: 24px;
            }
            
            .stat-number {
                font-size: 32px;
            }
        }
    </style>
</head>
<body>
    <!-- í—¤ë” -->
    <header id="header"></header>
    
    <!-- ëŒ€ì‹œë³´ë“œ ì»¨í…Œì´ë„ˆ -->
    <div class="dashboard-container">
        <!-- ë¡œë”© ìƒíƒœ -->
        <div id="loadingState" class="loading-container">
            <div class="loading-spinner"></div>
            <p style="margin-top: 20px; color: #6b7280;">ëŒ€ì‹œë³´ë“œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        </div>
        
        <!-- ëŒ€ì‹œë³´ë“œ ì½˜í…ì¸  -->
        <div id="dashboardContent" style="display: none;">
            <!-- í™˜ì˜ í—¤ë” -->
            <div class="welcome-header">
                <h1 class="welcome-title">í™˜ì˜í•©ë‹ˆë‹¤, <span id="userNickname">ì‚¬ìš©ì</span>ë‹˜!</h1>
                <p class="welcome-subtitle"><span id="businessName"></span> ì˜¤ëŠ˜ë„ ê¹¨ë—í•œ ê³µê°„ ê´€ë¦¬ë¥¼ ìœ„í•´ ë§í‚¤ê°€ í•¨ê»˜í•©ë‹ˆë‹¤.</p>
            </div>
            
            <!-- ì•Œë¦¼ ë°°ë„ˆ (í•„ìš”ì‹œ í‘œì‹œ) -->
            <div id="alertBanner" class="alert-banner warning" style="display: none;">
                <span class="alert-icon">âš ï¸</span>
                <span id="alertMessage"></span>
            </div>
            
            <!-- í†µê³„ ì¹´ë“œ -->
            <div class="stats-grid">
                <div class="stat-card" onclick="location.href='spaces.html'">
                    <div class="stat-header">
                        <span class="stat-icon">ğŸ¢</span>
                    </div>
                    <div class="stat-number" id="spaceCount">0</div>
                    <div class="stat-label">ë“±ë¡ëœ ê³µê°„</div>
                </div>
                
                <div class="stat-card" onclick="location.href='jobs.html?status=pending'">
                    <div class="stat-header">
                        <span class="stat-icon">â³</span>
                        <span class="stat-badge" id="pendingBadge" style="display: none;">NEW</span>
                    </div>
                    <div class="stat-number" id="pendingCount">0</div>
                    <div class="stat-label">ëŒ€ê¸° ì¤‘ì¸ ì‘ì—…</div>
                </div>
                
                <div class="stat-card" onclick="location.href='jobs.html?status=in_progress'">
                    <div class="stat-header">
                        <span class="stat-icon">ğŸ§¹</span>
                    </div>
                    <div class="stat-number" id="inProgressCount">0</div>
                    <div class="stat-label">ì§„í–‰ ì¤‘ì¸ ì‘ì—…</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-icon">ğŸ’°</span>
                    </div>
                    <div class="stat-number">â‚©<span id="monthlySpent">0</span></div>
                    <div class="stat-label">ì´ë²ˆ ë‹¬ ì§€ì¶œ</div>
                </div>
            </div>
            
            <!-- ë¹ ë¥¸ ì•¡ì…˜ -->
            <section class="section">
                <div class="section-header">
                    <h2 class="section-title">ë¹ ë¥¸ ì•¡ì…˜</h2>
                </div>
                <div class="quick-actions">
                    <a href="create-job.html" class="action-button">
                        <span class="icon">â•</span>
                        <span>ì •ë¦¬ ìš”ì²­í•˜ê¸°</span>
                    </a>
                    <a href="spaces.html" class="action-button">
                        <span class="icon">ğŸ¢</span>
                        <span>ê³µê°„ ê´€ë¦¬</span>
                    </a>
                    <a href="jobs.html" class="action-button">
                        <span class="icon">ğŸ“‹</span>
                        <span>ì‘ì—… ë‚´ì—­</span>
                    </a>
                    <a href="profile.html" class="action-button">
                        <span class="icon">âš™ï¸</span>
                        <span>í”„ë¡œí•„ ì„¤ì •</span>
                    </a>
                </div>
            </section>
            
            <!-- ìµœê·¼ ì‘ì—… -->
            <section class="section">
                <div class="section-header">
                    <h2 class="section-title">ìµœê·¼ ì‘ì—…</h2>
                    <a href="jobs.html" class="btn btn-outline">ì „ì²´ ë³´ê¸°</a>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ê³µê°„</th>
                            <th>ìš”ì²­ì¼</th>
                            <th>ìƒíƒœ</th>
                            <th>íŒŒíŠ¸ë„ˆ</th>
                            <th>ì‘ì—…</th>
                        </tr>
                    </thead>
                    <tbody id="recentJobs">
                        <tr>
                            <td colspan="5" style="text-align: center; color: #6b7280;">
                                ìµœê·¼ ì‘ì—…ì´ ì—†ìŠµë‹ˆë‹¤.
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </div>
    </div>
    
    <!-- í‘¸í„° -->
    <footer id="footer"></footer>
    
    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentUser = null;
        let businessProfile = null;
        
        // í˜ì´ì§€ ì´ˆê¸°í™”
        async function initializePage() {
            try {
                // ë¡œë”© í‘œì‹œ
                showLoading(true);
                
                console.log('ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì‹œì‘...');
                
                // Supabase í´ë¼ì´ì–¸íŠ¸ í™•ì¸
                if (!window.supabaseClient) {
                    throw new Error('Supabase í´ë¼ì´ì–¸íŠ¸ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                }
                
                // BusinessAPI ì¸ìŠ¤í„´ìŠ¤ í™•ì¸ ë° ìƒì„±
                if (!window.businessAPI) {
                    console.log('BusinessAPI ì¸ìŠ¤í„´ìŠ¤ ìƒì„±...');
                    window.businessAPI = new BusinessAPI();
                }
                
                // ì„¸ì…˜ í™•ì¸
                console.log('ì„¸ì…˜ í™•ì¸ ì¤‘...');
                const { data: { session } } = await window.supabaseClient.auth.getSession();
                if (!session) {
                    console.log('ì„¸ì…˜ ì—†ìŒ, ì¸ë±ìŠ¤ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸');
                    window.location.href = '../index.html';
                    return;
                }
                
                currentUser = session.user;
                console.log('í˜„ì¬ ì‚¬ìš©ì:', currentUser.id);
                
                // ì‚¬ìš©ì íƒ€ì… í™•ì¸
                const userType = currentUser.user_metadata?.user_type;
                console.log('ì‚¬ìš©ì íƒ€ì…:', userType);
                
                if (userType === 'partner') {
                    console.log('íŒŒíŠ¸ë„ˆ ì‚¬ìš©ìê°€ ë¹„ì¦ˆë‹ˆìŠ¤ ëŒ€ì‹œë³´ë“œ ì ‘ê·¼, íŒŒíŠ¸ë„ˆ ëŒ€ì‹œë³´ë“œë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸');
                    window.location.href = '../partners/dashboard.html';
                    return;
                } else if (userType !== 'business') {
                    console.log('ì•Œ ìˆ˜ ì—†ëŠ” ì‚¬ìš©ì íƒ€ì…, ë©”ì¸ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸');
                    window.location.href = '../index.html';
                    return;
                }
                
                // ë¹„ì¦ˆë‹ˆìŠ¤ í”„ë¡œí•„ ì¡°íšŒ
                console.log('í”„ë¡œí•„ ì¡°íšŒ ì¤‘...');
                const { data: profile, error } = await window.businessAPI.getProfile(currentUser.id);
                if (error || !profile) {
                    showAlert('í”„ë¡œí•„ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.', 'error');
                    await window.supabaseClient.auth.signOut();
                    window.location.href = './index.html';
                    return;
                }
                
                // ìŠ¹ì¸ ìƒíƒœ í™•ì¸
                if (profile.status !== 'approved') {
                    showAlert('ì•„ì§ ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì…ë‹ˆë‹¤. ìŠ¹ì¸ í›„ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'warning');
                }
                
                businessProfile = profile;
                
                // UI ì—…ë°ì´íŠ¸
                updateUI();
                
                // í†µê³„ ë¡œë“œ
                console.log('í†µê³„ ë¡œë“œ ì¤‘...');
                await loadStatistics();
                
                // ìµœê·¼ ì‘ì—… ë¡œë“œ
                console.log('ìµœê·¼ ì‘ì—… ë¡œë“œ ì¤‘...');
                await loadRecentJobs();
                
                console.log('ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì™„ë£Œ');
                
            } catch (error) {
                console.error('ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
                showAlert('í˜ì´ì§€ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            } finally {
                showLoading(false);
            }
        }
        
        // UI ì—…ë°ì´íŠ¸
        function updateUI() {
            // ë‹‰ë„¤ì„ê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ëª… í‘œì‹œ
            if (businessProfile.nickname) {
                document.getElementById('userNickname').textContent = businessProfile.nickname;
            }
            document.getElementById('businessName').textContent = businessProfile.business_name + ' -';
            
            // ì„ì‹œ ë°ì´í„° ê²½ê³  í‘œì‹œ
            if (businessProfile.business_number === '000-00-00000' || 
                businessProfile.business_type === 'other' ||
                businessProfile.business_address === 'ì£¼ì†Œ ë¯¸ì…ë ¥') {
                showAlert('í”„ë¡œí•„ ì •ë³´ë¥¼ ì—…ë°ì´íŠ¸í•´ì£¼ì„¸ìš”. ì¼ë¶€ ì •ë³´ê°€ ëˆ„ë½ë˜ì–´ ìˆìŠµë‹ˆë‹¤.', 'warning');
            }
        }
        
        // í†µê³„ ë¡œë“œ
        async function loadStatistics() {
            try {
                console.log('í†µê³„ API í˜¸ì¶œ...');
                const { data: stats, error } = await window.businessAPI.getStatistics(currentUser.id);
                if (error) {
                    console.error('í†µê³„ ë¡œë“œ ì—ëŸ¬:', error);
                    throw error;
                }
                
                // í†µê³„ ì—…ë°ì´íŠ¸
                document.getElementById('spaceCount').textContent = stats.total.space_count || 0;
                document.getElementById('pendingCount').textContent = stats.monthly.pending_jobs || 0;
                document.getElementById('inProgressCount').textContent = 
                    (stats.monthly.total_jobs - stats.monthly.completed_jobs - stats.monthly.pending_jobs) || 0;
                document.getElementById('monthlySpent').textContent = 
                    (stats.monthly.monthly_spent || 0).toLocaleString();
                
                // ëŒ€ê¸° ì¤‘ì¸ ì‘ì—…ì´ ìˆìœ¼ë©´ ë±ƒì§€ í‘œì‹œ
                if (stats.monthly.pending_jobs > 0) {
                    document.getElementById('pendingBadge').style.display = 'inline-block';
                }
                
            } catch (error) {
                console.error('í†µê³„ ë¡œë“œ ì˜¤ë¥˜:', error);
            }
        }
        
        // ìµœê·¼ ì‘ì—… ë¡œë“œ
        async function loadRecentJobs() {
            try {
                console.log('ì‘ì—… ëª©ë¡ API í˜¸ì¶œ...');
                const { data: jobs, error } = await window.businessAPI.getJobs(currentUser.id);
                if (error) {
                    console.error('ì‘ì—… ë¡œë“œ ì—ëŸ¬:', error);
                    throw error;
                }
                
                const recentJobs = jobs.slice(0, 5);  // ìµœê·¼ 5ê°œë§Œ
                const tbody = document.getElementById('recentJobs');
                
                if (recentJobs.length === 0) {
                    return;
                }
                
                tbody.innerHTML = recentJobs.map(job => `
                    <tr onclick="location.href='job-detail.html?id=${job.id}'" style="cursor: pointer;">
                        <td>${job.space?.name || '-'}</td>
                        <td>${new Date(job.created_at).toLocaleDateString()}</td>
                        <td>
                            <span class="status-badge ${job.status}">
                                ${getStatusText(job.status)}
                            </span>
                        </td>
                        <td>${job.partner?.name || '-'}</td>
                        <td>
                            <button class="btn btn-sm btn-outline">ìƒì„¸ë³´ê¸°</button>
                        </td>
                    </tr>
                `).join('');
                
            } catch (error) {
                console.error('ì‘ì—… ë¡œë“œ ì˜¤ë¥˜:', error);
            }
        }
        
        // ìƒíƒœ í…ìŠ¤íŠ¸ ë³€í™˜
        function getStatusText(status) {
            const statusMap = {
                pending: 'ëŒ€ê¸° ì¤‘',
                accepted: 'ìˆ˜ë½ë¨',
                in_progress: 'ì§„í–‰ ì¤‘',
                completed: 'ì™„ë£Œ',
                cancelled: 'ì·¨ì†Œë¨'
            };
            return statusMap[status] || status;
        }
        
        // ì•Œë¦¼ í‘œì‹œ
        function showAlert(message, type = 'warning') {
            const banner = document.getElementById('alertBanner');
            const messageEl = document.getElementById('alertMessage');
            
            banner.className = `alert-banner ${type}`;
            messageEl.textContent = message;
            banner.style.display = 'flex';
        }
        
        // ë¡œë”© í‘œì‹œ
        function showLoading(show) {
            document.getElementById('loadingState').style.display = show ? 'flex' : 'none';
            document.getElementById('dashboardContent').style.display = show ? 'none' : 'block';
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM ë¡œë“œ ì™„ë£Œ');
            
            // BusinessAPI ê°•ì œ í™•ì¸ ë° ìƒì„±
            if (!window.businessAPI) {
                console.log('BusinessAPI ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ë™ ìƒì„±');
                window.businessAPI = new BusinessAPI();
            }
            console.log('BusinessAPI ì¤€ë¹„ ì™„ë£Œ:', typeof window.businessAPI);
            
            // í—¤ë”/í‘¸í„° ë¡œë“œ
            loadComponent('header', '../components/header.html');
            loadComponent('footer', '../components/footer.html');
            
            // 30ì´ˆ íƒ€ì„ì•„ì›ƒìœ¼ë¡œ í˜ì´ì§€ ì´ˆê¸°í™”
            const timeoutId = setTimeout(() => {
                showAlert('í˜ì´ì§€ ë¡œë”©ì´ ë„ˆë¬´ ì˜¤ë˜ ê±¸ë¦½ë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì„¸ìš”.', 'error');
                showLoading(false);
            }, 30000);
            
            // í˜ì´ì§€ ì´ˆê¸°í™”
            initializePage().finally(() => {
                clearTimeout(timeoutId);
            });
        });
        
        // ì»´í¬ë„ŒíŠ¸ ë¡œë“œ í•¨ìˆ˜
        async function loadComponent(id, path) {
            try {
                const response = await fetch(path);
                const html = await response.text();
                document.getElementById(id).innerHTML = html;
            } catch (error) {
                console.error(`${id} ë¡œë“œ ì˜¤ë¥˜:`, error);
            }
        }
    </script>
</body>
</html>