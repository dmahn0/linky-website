<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë¦¬ë‹¤ì´ë ‰íŠ¸ ë””ë²„ê¹…</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .result { background: #f5f5f5; padding: 10px; margin: 10px 0; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
    </style>
</head>
<body>
    <h1>ğŸ” ë¦¬ë‹¤ì´ë ‰íŠ¸ ë””ë²„ê¹… ë„êµ¬</h1>
    
    <div class="section">
        <h2>1. í˜„ì¬ ìœ„ì¹˜ ì •ë³´</h2>
        <div id="locationInfo" class="result"></div>
    </div>

    <div class="section">
        <h2>2. ë¦¬ë‹¤ì´ë ‰íŠ¸ í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testRedirect1()">window.location.href í…ŒìŠ¤íŠ¸</button>
        <button onclick="testRedirect2()">window.location.replace í…ŒìŠ¤íŠ¸</button>
        <button onclick="testRedirect3()">window.location.assign í…ŒìŠ¤íŠ¸</button>
        <button onclick="testRedirect4()">setTimeout ë¦¬ë‹¤ì´ë ‰íŠ¸ í…ŒìŠ¤íŠ¸</button>
        <div id="redirectResult" class="result"></div>
    </div>

    <div class="section">
        <h2>3. ê²½ë¡œ í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testPath('index.html')">ìƒëŒ€ê²½ë¡œ: index.html</button>
        <button onclick="testPath('./index.html')">ìƒëŒ€ê²½ë¡œ: ./index.html</button>
        <button onclick="testPath('/src/partners/index.html')">ì ˆëŒ€ê²½ë¡œ: /src/partners/index.html</button>
        <button onclick="testPath('../partners/index.html')">ìƒìœ„ê²½ë¡œ: ../partners/index.html</button>
        <div id="pathResult" class="result"></div>
    </div>

    <div class="section">
        <h2>4. ì‹¤ì œ ë¡œê·¸ì•„ì›ƒ ì‹œë®¬ë ˆì´ì…˜</h2>
        <button onclick="simulateLogout()">ë¡œê·¸ì•„ì›ƒ í”Œë¡œìš° ì‹œë®¬ë ˆì´ì…˜</button>
        <div id="simulationResult" class="result"></div>
    </div>

    <script>
        // í˜ì´ì§€ ë¡œë“œì‹œ í˜„ì¬ ìœ„ì¹˜ ì •ë³´ í‘œì‹œ
        window.addEventListener('DOMContentLoaded', () => {
            const info = document.getElementById('locationInfo');
            info.innerHTML = `
                <div class="info"><strong>í˜„ì¬ URL:</strong> ${window.location.href}</div>
                <div class="info"><strong>Protocol:</strong> ${window.location.protocol}</div>
                <div class="info"><strong>Host:</strong> ${window.location.host}</div>
                <div class="info"><strong>Pathname:</strong> ${window.location.pathname}</div>
                <div class="info"><strong>í˜„ì¬ ë””ë ‰í† ë¦¬:</strong> ${window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/'))}/</div>
            `;
        });

        // 1. window.location.href í…ŒìŠ¤íŠ¸
        function testRedirect1() {
            const result = document.getElementById('redirectResult');
            try {
                result.innerHTML = '<div class="info">window.location.href = "index.html" ì‹¤í–‰ì¤‘...</div>';
                console.log('Testing window.location.href...');
                
                // ì‹¤ì œë¡œ ì´ë™í•˜ì§€ ì•Šê³  í…ŒìŠ¤íŠ¸ë§Œ
                const newUrl = new URL('index.html', window.location.href);
                result.innerHTML = `
                    <div class="success">âœ… window.location.href ì‘ë™ ê°€ëŠ¥</div>
                    <div class="info">ì˜ˆìƒ ì´ë™ ê²½ë¡œ: ${newUrl.href}</div>
                `;
            } catch (error) {
                result.innerHTML = `<div class="error">âŒ ì—ëŸ¬: ${error.message}</div>`;
            }
        }

        // 2. window.location.replace í…ŒìŠ¤íŠ¸
        function testRedirect2() {
            const result = document.getElementById('redirectResult');
            try {
                result.innerHTML = '<div class="info">window.location.replace("index.html") ì‹¤í–‰ì¤‘...</div>';
                console.log('Testing window.location.replace...');
                
                const newUrl = new URL('index.html', window.location.href);
                result.innerHTML = `
                    <div class="success">âœ… window.location.replace ì‘ë™ ê°€ëŠ¥</div>
                    <div class="info">ì˜ˆìƒ ì´ë™ ê²½ë¡œ: ${newUrl.href}</div>
                `;
            } catch (error) {
                result.innerHTML = `<div class="error">âŒ ì—ëŸ¬: ${error.message}</div>`;
            }
        }

        // 3. window.location.assign í…ŒìŠ¤íŠ¸
        function testRedirect3() {
            const result = document.getElementById('redirectResult');
            try {
                result.innerHTML = '<div class="info">window.location.assign("index.html") ì‹¤í–‰ì¤‘...</div>';
                console.log('Testing window.location.assign...');
                
                const newUrl = new URL('index.html', window.location.href);
                result.innerHTML = `
                    <div class="success">âœ… window.location.assign ì‘ë™ ê°€ëŠ¥</div>
                    <div class="info">ì˜ˆìƒ ì´ë™ ê²½ë¡œ: ${newUrl.href}</div>
                `;
            } catch (error) {
                result.innerHTML = `<div class="error">âŒ ì—ëŸ¬: ${error.message}</div>`;
            }
        }

        // 4. setTimeout ë¦¬ë‹¤ì´ë ‰íŠ¸ í…ŒìŠ¤íŠ¸
        function testRedirect4() {
            const result = document.getElementById('redirectResult');
            result.innerHTML = '<div class="info">setTimeoutìœ¼ë¡œ 3ì´ˆ í›„ ë¦¬ë‹¤ì´ë ‰íŠ¸ í…ŒìŠ¤íŠ¸...</div>';
            
            let countdown = 3;
            const timer = setInterval(() => {
                countdown--;
                if (countdown > 0) {
                    result.innerHTML = `<div class="info">${countdown}ì´ˆ í›„ ë¦¬ë‹¤ì´ë ‰íŠ¸...</div>`;
                } else {
                    clearInterval(timer);
                    result.innerHTML = '<div class="success">âœ… íƒ€ì´ë¨¸ ì™„ë£Œ (ì‹¤ì œë¡œ ì´ë™í•˜ì§€ëŠ” ì•ŠìŒ)</div>';
                }
            }, 1000);
        }

        // 5. ê²½ë¡œ í…ŒìŠ¤íŠ¸
        function testPath(path) {
            const result = document.getElementById('pathResult');
            try {
                const baseUrl = window.location.href.substring(0, window.location.href.lastIndexOf('/') + 1);
                let resolvedUrl;
                
                if (path.startsWith('/')) {
                    // ì ˆëŒ€ ê²½ë¡œ
                    resolvedUrl = window.location.origin + path;
                } else if (path.startsWith('../')) {
                    // ìƒìœ„ ë””ë ‰í† ë¦¬
                    const parentDir = baseUrl.substring(0, baseUrl.slice(0, -1).lastIndexOf('/') + 1);
                    resolvedUrl = parentDir + path.substring(3);
                } else if (path.startsWith('./')) {
                    // í˜„ì¬ ë””ë ‰í† ë¦¬ (ëª…ì‹œì )
                    resolvedUrl = baseUrl + path.substring(2);
                } else {
                    // ìƒëŒ€ ê²½ë¡œ
                    resolvedUrl = baseUrl + path;
                }
                
                result.innerHTML = `
                    <div class="success">âœ… ê²½ë¡œ í•´ì„ ì„±ê³µ</div>
                    <div class="info"><strong>ì…ë ¥ ê²½ë¡œ:</strong> ${path}</div>
                    <div class="info"><strong>ì ˆëŒ€ ê²½ë¡œ:</strong> ${resolvedUrl}</div>
                    <div class="info"><strong>íŒŒì¼ ì¡´ì¬ í™•ì¸:</strong> <span id="fileCheck">í™•ì¸ì¤‘...</span></div>
                `;
                
                // íŒŒì¼ ì¡´ì¬ í™•ì¸ (fetchë¡œ HEAD ìš”ì²­)
                fetch(resolvedUrl, { method: 'HEAD' })
                    .then(response => {
                        const checkSpan = document.getElementById('fileCheck');
                        if (response.ok) {
                            checkSpan.innerHTML = '<span class="success">âœ… íŒŒì¼ ì¡´ì¬</span>';
                        } else {
                            checkSpan.innerHTML = `<span class="error">âŒ íŒŒì¼ ì—†ìŒ (${response.status})</span>`;
                        }
                    })
                    .catch(error => {
                        document.getElementById('fileCheck').innerHTML = `<span class="error">âŒ í™•ì¸ ì‹¤íŒ¨: ${error.message}</span>`;
                    });
                    
            } catch (error) {
                result.innerHTML = `<div class="error">âŒ ê²½ë¡œ í•´ì„ ì—ëŸ¬: ${error.message}</div>`;
            }
        }

        // 6. ì‹¤ì œ ë¡œê·¸ì•„ì›ƒ ì‹œë®¬ë ˆì´ì…˜
        async function simulateLogout() {
            const result = document.getElementById('simulationResult');
            result.innerHTML = '<div class="info">ë¡œê·¸ì•„ì›ƒ í”Œë¡œìš° ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘...</div>';
            
            try {
                // Step 1: í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸
                result.innerHTML += '<div class="info">Step 1: í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ (ì‹œë®¬ë ˆì´ì…˜ì—ì„œëŠ” ìŠ¤í‚µ)</div>';
                
                // Step 2: ë²„íŠ¼ ë¹„í™œì„±í™”
                result.innerHTML += '<div class="info">Step 2: ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ ë¹„í™œì„±í™”</div>';
                
                // Step 3: ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬ (ì‹œë®¬ë ˆì´ì…˜)
                result.innerHTML += '<div class="info">Step 3: authManager.logout() í˜¸ì¶œ (ì‹œë®¬ë ˆì´ì…˜)</div>';
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Step 4: ì„¸ì…˜ í™•ì¸
                result.innerHTML += '<div class="info">Step 4: ì„¸ì…˜ ì¬í™•ì¸</div>';
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Step 5: setTimeout ëŒ€ê¸°
                result.innerHTML += '<div class="info">Step 5: 100ms ëŒ€ê¸°ì¤‘...</div>';
                await new Promise(resolve => setTimeout(resolve, 100));
                
                // Step 6: ë¦¬ë‹¤ì´ë ‰íŠ¸ ì‹œë„
                result.innerHTML += '<div class="info">Step 6: window.location.replace("index.html") í˜¸ì¶œ</div>';
                
                const targetUrl = new URL('index.html', window.location.href);
                result.innerHTML += `
                    <div class="success">âœ… ì‹œë®¬ë ˆì´ì…˜ ì™„ë£Œ</div>
                    <div class="info"><strong>ìµœì¢… ì´ë™ ê²½ë¡œ:</strong> ${targetUrl.href}</div>
                    <div class="info">ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” ì´ ê²½ë¡œë¡œ ì´ë™ë©ë‹ˆë‹¤.</div>
                `;
                
            } catch (error) {
                result.innerHTML += `<div class="error">âŒ ì‹œë®¬ë ˆì´ì…˜ ì—ëŸ¬: ${error.message}</div>`;
                console.error('Simulation error:', error);
            }
        }
    </script>
</body>
</html>